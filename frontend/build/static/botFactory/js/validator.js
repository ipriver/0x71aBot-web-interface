!function(n,e){var r="undefined"!=typeof module&&module.exports,t="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(r){var u=require("underscore");module.exports=e(n,u)}else t?define(["underscore"],function(r){return e(n,r)}):n.Validator=e(n,n._)}(this,function(n,e){"use strict";var r=function(n){n||(n={}),n.rules&&e.extend(this.rules,n.rules)};r.prototype=function(){var n=function(n){return!(e.isUndefined(n)||e.isNull(n))};return{constructor:r,validate:function(r,t,u){u||(u={});var i=this,o=e.isObject(r)?r:{__single__:r},s=e.isObject(r)?t:{__single__:t},a={};return e.each(s,function(r,t){var u=a[t]=[],s=e.result(o,t);!(!1===n(s)&&!0===e.has(r,"required")&&!1===e.result(r,"required"))&&e.each(r,function(n,r){e.has(i.rules,r)?!1===i.rules[r].call(i,s,n,o)&&u.push({value:s,rule:r,standard:n}):console&&console.warn("Validation rule '%s' is not exists",r)})}),e.isObject(r)?a:a.__single__},rules:{email:function(n,e){var r=new RegExp("^[a-z0-9._%-]+@[a-z0-9.-]*[a-z0-9]{1}.[a-z]{2,4}$","i");return this.rules.regexp(n,r)==e},russians:function(n,e){var r=/^[А-Яа-яёЁ\W]$/i;return this.rules.regexp(n,r)==e},string:function(n,e){return"string"==typeof n},boolean:function(n,e){return"boolean"==typeof n&&!0===e},number:function(n,e){return"number"==typeof n&&1==e},integer:function(n,e){return"number"==typeof n&&n%1==0&&1==e},regexp:function(n,e){var r=e instanceof RegExp?e:new RegExp(e);return"string"==typeof n&&r.test(n)},enum:function(n,r){return r instanceof Array&&-1!=e.indexOf(r,n)},minimum:function(n,e){return!!this.rules.number.call(this,n,!0)&&parseInt(n,10)>=e},maximum:function(n,e){return!!this.rules.number.call(this,n,!0)&&parseInt(n,10)<=e},minlength:function(n,e){return"string"==typeof n&&n.length>=e},maxlength:function(n,e){return"string"==typeof n&&n.length<=e},required:function(e,r){return!0!==r||n(e)}}}}();var t=function(){};return t.prototype=function(){var n={STRING:"string",NUMBER:"number",INTEGER:"integer",BOOLEAN:"boolean",REGEXP:"regexp",MINIMUM:"minimum",MAXIMUM:"maximum",MIN_LENGTH:"minlength",MAX_LENGTH:"maxlength",REQUIRED:"required",ENUMERATION:"enum"},r={TYPE:"type",MINIMUM:"minimum",MAXIMUM:"maximum",MIN_LENGTH:"minLength",MAX_LENGTH:"maxLength",REGEXP:"pattern",REQUIRED:"required",ENUMERATION:"enum"},u={STRING:"string",NUMBER:"number",INTEGER:"integer",BOOLEAN:"boolean"},i=function(){var e={};return e[r.MINIMUM]=n.MINIMUM,e[r.MAXIMUM]=n.MAXIMUM,e[r.MIN_LENGTH]=n.MIN_LENGTH,e[r.MAX_LENGTH]=n.MAX_LENGTH,e[r.REGEXP]=n.REGEXP,e[r.ENUMERATION]=n.ENUMERATION,function(n,r){return{rule:e[r],standard:n}}}(),o={};return o[r.TYPE]=function(){var e={};return e[u.STRING]=n.STRING,e[u.NUMBER]=n.NUMBER,e[u.INTEGER]=n.INTEGER,e[u.BOOLEAN]=n.BOOLEAN,function(n){return{rule:e[n],standard:!0}}}(),o[r.MINIMUM]=i,o[r.MAXIMUM]=i,o[r.MIN_LENGTH]=i,o[r.MAX_LENGTH]=i,o[r.REGEXP]=i,o[r.ENUMERATION]=i,{constructor:t,convert:function(r){if(r){var t={};return e.each(r.properties,function(u,i){t[i]=e.reduce(u,function(n,e,r){if(!o[r])return n;var t=o[r].call(null,e,r);return n[t.rule]=t.standard,n},{}),t[i][n.REQUIRED]=-1!==e.indexOf(r.required,i)}),t}return null}}}(),r.convertSchema=(new t).convert,r});